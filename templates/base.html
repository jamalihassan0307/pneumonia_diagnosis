{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Pneumonia Diagnosis System{% endblock %}</title>
    
    <!-- Preconnect to Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Base Styles -->
    <link rel="stylesheet" href="{% static 'css/base.css' %}">
    
    <!-- Page-specific Styles -->
    {% block extra_css %}{% endblock %}
    
    <style>
        /* Override for responsive design if needed */
        {% block inline_css %}{% endblock %}
    </style>
</head>
<body>
    <!-- Medical Glassmorphism Navigation -->
    <nav class="navbar" id="navbar">
        <div class="nav-left">
            <div class="logo">PneumoAI</div>
            <div class="nav-title">Medical AI Diagnostics</div>
        </div>
        
        <button class="mobile-menu-btn" id="mobileMenuBtn" onclick="toggleMobileMenu()">‚ò∞</button>
        
        <div class="nav-links" id="navLinks">
            <a href="/dashboard/" class="nav-link {% block nav_dashboard %}{% endblock %}" onclick="closeMobileMenu()">
                <span>Dashboard</span>
            </a>
            <a href="/upload/" class="nav-link {% block nav_upload %}{% endblock %}" onclick="closeMobileMenu()">
                <span>ü©ª New Prediction</span>
            </a>
            <a href="/results/" class="nav-link {% block nav_results %}{% endblock %}" onclick="closeMobileMenu()">
                <span>History</span>
            </a>
            <a href="/profile/" class="nav-link {% block nav_profile %}{% endblock %}" onclick="closeMobileMenu()">
                <span>Profile</span>
            </a>
            <a href="/model-info/" class="nav-link {% block nav_model %}{% endblock %}" onclick="closeMobileMenu()">
                <span>Model</span>
            </a>
        </div>
        
        <div class="nav-right" id="navRight">
            <div class="user-info">
                <span id="userName">{{ request.user.username }}</span>
            </div>
            <button class="logout-btn" onclick="logout()">Logout</button>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="main-container">
        {% block content %}{% endblock %}
    </div>

    <!-- Medical Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>ü´Å PneumoAI</h4>
                <p>Advanced AI-powered pneumonia detection system using cutting-edge deep learning technology for accurate respiratory health diagnostics.</p>
            </div>
            <div class="footer-section">
                <h4>Quick Links</h4>
                <ul>
                    <li><a href="/dashboard/">Dashboard</a></li>
                    <li><a href="/upload/">New Prediction</a></li>
                    <li><a href="/results/">Analysis History</a></li>
                    <li><a href="/model-info/">Model Information</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Medical Support</h4>
                <ul>
                    <li><a href="#">Clinical Guidelines</a></li>
                    <li><a href="#">User Documentation</a></li>
                    <li><a href="#">FAQs</a></li>
                    <li><a href="#">Contact Support</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Legal & Compliance</h4>
                <ul>
                    <li><a href="#">HIPAA Compliance</a></li>
                    <li><a href="#">Privacy Policy</a></li>
                    <li><a href="#">Terms of Service</a></li>
                    <li><a href="#">Medical Disclaimer</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2026 PneumoAI Medical Diagnostics. All rights reserved. | Powered by MobileNetV2</p>
        </div>
    </footer>

    <!-- Base Scripts -->
    <script src="{% static 'js/base.js' %}"></script>
    
    <!-- Page-specific Scripts -->
    {% block extra_js %}{% endblock %}
    
    <script>
        // Mobile Menu Toggle
        function toggleMobileMenu() {
            const navLinks = document.getElementById('navLinks');
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            navLinks.classList.toggle('active');
            mobileMenuBtn.textContent = navLinks.classList.contains('active') ? '‚úï' : '‚ò∞';
        }

        function closeMobileMenu() {
            const navLinks = document.getElementById('navLinks');
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            navLinks.classList.remove('active');
            mobileMenuBtn.textContent = '‚ò∞';
        }

        // Close mobile menu when clicking outside
        document.addEventListener('click', function(event) {
            const navbar = document.getElementById('navbar');
            if (!navbar.contains(event.target)) {
                closeMobileMenu();
            }
        });

        // Navbar scroll effect
        window.addEventListener('scroll', function() {
            const navbar = document.getElementById('navbar');
            if (window.scrollY > 50) {
                navbar.classList.add('scrolled');
            } else {
                navbar.classList.remove('scrolled');
            }
        });

        // Global logout function
        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                window.location.href = '{% url "xray_detector:logout" %}';
            }
        }

        // Animate counters
        function animateCounter(element, start, end, duration) {
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                element.textContent = Math.floor(progress * (end - start) + start);
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                }
            };
            window.requestAnimationFrame(step);
        }

        // Smooth scroll for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Add fade-in animation to cards on page load
        document.addEventListener('DOMContentLoaded', function() {
            const cards = document.querySelectorAll('.card');
            cards.forEach((card, index) => {
                setTimeout(() => {
                    card.style.opacity = '0';
                    card.style.transform = 'translateY(20px)';
                    card.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                    setTimeout(() => {
                        card.style.opacity = '1';
                        card.style.transform = 'translateY(0)';
                    }, 50);
                }, index * 100);
            });
        });

        // Dismiss messages after 5 seconds
        document.addEventListener('DOMContentLoaded', function() {
            const messages = document.querySelectorAll('.message.active');
            messages.forEach(message => {
                setTimeout(() => {
                    message.style.opacity = '0';
                    message.style.transform = 'translateX(100%)';
                    setTimeout(() => {
                        message.remove();
                    }, 300);
                }, 5000);
            });
        });

        // Display logged-in user info with medical professional indicator
        if (document.getElementById('userName')) {
            const username = '{{ request.user.username }}';
            document.getElementById('userName').textContent = username || 'Medical Professional';
        }
    </script>
</body>
</html>
